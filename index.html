<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Streamer.bot Commands</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Streamer.bot Commands</h1>
    <div id="commandSections">
      <!-- Sections will be dynamically generated here -->
    </div>
    <p id="errorMessage" class="error"></p>
  </div>

  <script>
    async function loadCommands() {
      const errorEl = document.getElementById('errorMessage');
      try {
        const res = await fetch('commands.json'); // relative path in same repo
        if (!res.ok) throw new Error("Failed to fetch JSON");
        const data = await res.json();

        const sections = {
          "Everyone": [],
          "Subs Only": [],
          "VIP Only": [],
          "Mods Only": []
        };

        // Group commands by access
        data.forEach(cmd => {
          if (sections[cmd.Access]) sections[cmd.Access].push(cmd);
          else sections["Everyone"].push(cmd); // fallback
        });

        const container = document.getElementById('commandSections');
        container.innerHTML = '';

        // Render each section
        Object.keys(sections).forEach(access => {
          if (sections[access].length === 0) return; // skip empty sections

          const sectionDiv = document.createElement('div');
          sectionDiv.className = 'section';

          const header = document.createElement('h2');
          header.textContent = access;
          sectionDiv.appendChild(header);

          const table = document.createElement('table');
          const thead = document.createElement('thead');
          thead.innerHTML = "<tr><th>Command</th></tr>";
          table.appendChild(thead);

          const tbody = document.createElement('tbody');
          sections[access].forEach(cmd => {
            const row = document.createElement('tr');
            row.innerHTML = `<td>${cmd.Name}</td>`;
            tbody.appendChild(row);
          });
          table.appendChild(tbody);

          sectionDiv.appendChild(table);
          container.appendChild(sectionDiv);
        });

        errorEl.textContent = '';
      } catch(err) {
        console.error("Failed to load commands:", err);
        errorEl.textContent = 'Unable to load commands. Please try again later.';
      }
    }

    loadCommands();
    setInterval(loadCommands, 60000); // refresh every 60 seconds
  </script>
</body>
</html>
